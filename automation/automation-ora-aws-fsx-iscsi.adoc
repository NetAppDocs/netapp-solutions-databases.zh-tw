---
sidebar: sidebar 
permalink: automation/automation-ora-aws-fsx-iscsi.html 
keywords: Database, Oracle, AWS, FSx, ONTAP, Automation 
summary: 該解決方案提供了在Amazon FSx ONTAP中自動部署和保護 Oracle 的概述和詳細信息，其中 Amazon FSx ONTAP 是使用 iSCSI 協議作為主數據庫存儲，而 Oracle 數據庫則在獨立 ReStart 中配置，並使用 Oracle asm 作為捲管理器。 
---
= TR-4986：使用 iSCSI 在Amazon FSx ONTAP上簡化、自動化 Oracle 部署
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


Allen Cao、Niyaz Mohamed， NetApp

[role="lead"]
該解決方案提供了在Amazon FSx ONTAP中自動部署和保護 Oracle 的概述和詳細信息，該部署和保護作為具有 iSCSI 協議的主數據庫存儲，並在獨立 ReStart 中使用 Oracle asm 作為捲管理器配置 Oracle 數據庫。



== 目的

Amazon FSx ONTAP是一種儲存服務，可讓您在 AWS 雲端中啟動和執行完全託管的NetApp ONTAP檔案系統。它提供NetApp檔案系統熟悉的功能、效能、能力和 API，以及完全託管的 AWS 服務的靈活性、可擴充性和簡單性。它可讓您安心地在 AWS 雲端中執行最嚴苛的資料庫工作負載，例如 Oracle。

本文檔示範了使用 Ansible 自動化在Amazon FSx ONTAP檔案系統中簡化 Oracle 資料庫的部署。 Oracle 資料庫部署在獨立的 ReStart 配置中，使用 iSCSI 協定進行資料訪問，使用 Oracle ASM 進行資料庫儲存磁碟管理。它還提供有關使用NetApp SnapCenter UI 工具備份、恢復和克隆 Oracle 資料庫的信息，以便在 AWS 雲端中進行儲存高效的資料庫操作。

此解決方案適用於以下用例：

* 在Amazon FSx ONTAP檔案系統上自動部署 Oracle 資料庫
* 使用NetApp SnapCenter工具在Amazon FSx ONTAP檔案系統上備份和還原 Oracle 資料庫
* 使用NetApp SnapCenter工具在Amazon FSx ONTAP檔案系統上複製用於開發/測試或其他使用案例的 Oracle 資料庫




== 對象

此解決方案適用於以下人群：

* 想要在Amazon FSx ONTAP檔案系統上部署 Oracle 的 DBA。
* 一位資料庫解決方案架構師想要在Amazon FSx ONTAP檔案系統上測試 Oracle 工作負載。
* 一位儲存管理員想要在Amazon FSx ONTAP檔案系統上部署和管理 Oracle 資料庫。
* 希望在Amazon FSx ONTAP檔案系統上建立 Oracle 資料庫的應用程式擁有者。




== 解決方案測試和驗證環境

此解決方案的測試和驗證是在實驗室環境中進行的，可能與最終部署環境不符。請參閱<<部署考慮的關鍵因素>>了解更多。



=== 架構

image:automation-ora-aws-fsx-iscsi-architecture.png["此圖提供了具有 iSCSI 和 ASM 的 AWS 公有雲中的 Oracle 部署配置的詳細圖片。"]



=== 硬體和軟體組件

[cols="33%, 33%, 33%"]
|===


3+| *硬體* 


| Amazon FSx ONTAP存儲 | AWS 提供的目前版本 | 同一 VPC 和可用區中的一個 FSx HA 集群 


| 用於計算的 EC2 實例 | t2.xlarge/4vCPU/16G | 兩個 EC2 T2 xlarge EC2 執行個體用於並發部署 


3+| *軟體* 


| 紅帽Linux | RHEL-8.6，4.18.0-372.9.1.el8.x86_64 內核 | 部署 RedHat 訂閱進行測試 


| Windows 伺服器 | 2022 標準版，10.0.20348 內部版本 20348 | 託管SnapCenter伺服器 


| Oracle 網格基礎架構 | 版本 19.18 | 已套用RU補丁p34762026_190000_Linux-x86-64.zip 


| Oracle 資料庫 | 版本 19.18 | 已套用RU補丁p34765931_190000_Linux-x86-64.zip 


| Oracle OPatch | 版本 12.2.0.1.36 | 最新補丁 p6880880_190000_Linux-x86-64.zip 


| SnapCenter伺服器 | 版本 4.9P1 | 工作小組部署 


| 開啟 JDK | 版本 java-1.8.0-openjdk.x86_64 | 資料庫虛擬機器上的SnapCenter插件要求 
|===


=== 實驗室環境中的 Oracle 資料庫配置

[cols="33%, 33%, 33%"]
|===


3+|  


| *伺服器* | *資料庫* | *資料庫儲存* 


| ora_01 | NTAP1(NTAP1_PDB1、NTAP1_PDB2、NTAP1_PDB3) | Amazon FSx ONTAP檔案系統上的 iSCSI lun 


| ora_02 | NTAP2(NTAP2_PDB1、NTAP2_PDB2、NTAP2_PDB3) | Amazon FSx ONTAP檔案系統上的 iSCSI lun 
|===


=== 部署考慮的關鍵因素

* Oracle 資料庫儲存佈局。在此自動化 Oracle 部署中，我們預設配置四個資料庫磁碟區來託管 Oracle 二進位檔案、資料和日誌。磁碟區中的單一 LUN 指派給 Oracle 二進位。然後，我們從資料和日誌 LUN 建立兩個 ASM 磁碟組。在 +DATA asm 磁碟組中，我們配置兩個資料卷，每個磁碟區有兩個 LUN。在 +LOGS asm 磁碟組中，我們在日誌磁碟區中建立兩個 lun。  ONTAP磁碟區內佈局的多個 LUN 通常可提供更好的效能。
* *多個資料庫伺服器部署。 *自動化解決方案可以在單一 Ansible 劇本運行中將 Oracle 容器資料庫部署到多個 DB 伺服器。無論資料庫伺服器的數量有多少，劇本的執行都保持不變。您可以將多個容器資料庫部署到具有不同資料庫執行個體 ID（Oracle SID）的單一 EC2 執行個體。但要確保主機上有足夠的記憶體來支援部署的資料庫。
* iSCSI 配置。  EC2 執行個體資料庫伺服器透過 iSCSI 協定連接到 FSx 儲存。 EC2 執行個體通常部署單一網路介面或 ENI。單一 NIC 介面同時承載 iSCSI 和應用程式流量。透過仔細分析 Oracle AWR 報告來衡量 Oracle 資料庫峰值 I/O 吞吐量需求非常重要，這樣才能選擇滿足應用程式和 iSCSI 流量吞吐量要求的正確 EC2 計算執行個體。此外，AWS EC2 通常將每個 TCP 流限制為 5 Gbps。每個 iSCSI 路徑提供 5 Gbps (625 MBps) 的頻寬，並且可能需要多個 iSCSI 連線來支援更高的吞吐量需求。
* *您建立的每個 Oracle ASM 磁碟組所使用的 Oracle ASM 冗餘等級。 *由於Amazon FSx ONTAP已啟用 HA 以在叢集磁碟層級進行資料保護，因此您應該使用 `External Redundancy`，這表示該選項不允許 Oracle ASM 鏡像磁碟組的內容。
* *資料庫備份。 *  NetApp提供了SnapCenter software套件，用於資料庫備份、復原和克隆，並具有使用者友好的 UI 介面。  NetApp建議實施這樣的管理工具，以實現快速（一分鐘內）的 SnapShot 備份、快速（幾分鐘內）的資料庫復原和資料庫複製。




== 解決方案部署

以下部分提供了在Amazon FSx ONTAP檔案系統上自動部署和保護 Oracle 19c 的逐步過程，其中資料庫 lun 透過 iSCSI 直接安裝到單節點重新啟動配置中的 EC2 執行個體 VM，並使用 Oracle ASM 作為資料庫磁碟區管理器。



=== 部署先決條件

[%collapsible%open]
====
部署需要以下先決條件。

. 已設定 AWS 帳戶，並在您的 AWS 帳戶內建立了必要的 VPC 和網路段。
. 從 AWS EC2 控制台，將 EC2 Linux 執行個體部署為 Oracle DB 伺服器。為 ec2-user 啟用 SSH 私鑰/公鑰身份驗證。有關環境設定的詳細信息，請參閱上一節中的架構圖。還請查看link:https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html["Linux 實例使用者指南"^]了解更多。
. 從 AWS FSx 控制台，設定符合需求的Amazon FSx ONTAP檔案系統。查看文件link:https://docs.aws.amazon.com/fsx/latest/ONTAPGuide/creating-file-systems.html["建立 FSx ONTAP檔案系統"^]以獲得逐步說明。
. 步驟 2 和 3 可以使用以下 Terraform 自動化工具包執行，該工具包會建立一個名為 `ora_01`以及一個名為 `fsx_01`。在執行之前，請仔細檢查說明並更改變數以適合您的環境。此範本可以根據您自己的部署要求輕鬆修改。
+
[source, cli]
----
git clone https://github.com/NetApp-Automation/na_aws_fsx_ec2_deploy.git
----
. 將 EC2 Linux 執行個體配置為 Ansible 控制器節點，並安裝最新版本的 Ansible 和 Git。詳細資訊請參考以下連結：link:https://docs.netapp.com/us-en/netapp-solutions-dataops/automation/getting-started.html["NetApp解決方案自動化入門^"^]在第 -
`Setup the Ansible Control Node for CLI deployments on RHEL / CentOS`或者
`Setup the Ansible Control Node for CLI deployments on Ubuntu / Debian`。
. 配置 Windows 伺服器以運行最新版本的NetApp SnapCenter UI 工具。詳細資訊請參考以下連結：link:https://docs.netapp.com/us-en/snapcenter/install/task_install_the_snapcenter_server_using_the_install_wizard.html["安裝SnapCenter伺服器"^]
. 克隆適用於 iSCSI 的NetApp Oracle 部署自動化工具包的副本。
+
[source, cli]
----
git clone https://bitbucket.ngage.netapp.com/scm/ns-bb/na_oracle_deploy_iscsi.git
----
. 在 EC2 執行個體 /tmp/archive 目錄上依照 Oracle 19c 安裝檔案進行階段。
+
....
installer_archives:
  - "LINUX.X64_193000_grid_home.zip"
  - "p34762026_190000_Linux-x86-64.zip"
  - "LINUX.X64_193000_db_home.zip"
  - "p34765931_190000_Linux-x86-64.zip"
  - "p6880880_190000_Linux-x86-64.zip"
....
+

NOTE: 請確定您已在 Oracle VM 根磁碟區中指派至少 50G，以便有足夠的空間儲存 Oracle 安裝檔案。

. 觀看以下影片：
+
.使用 iSCSI 在Amazon FSx ONTAP上簡化和自動化 Oracle 部署
video::81e389a0-d9b8-495c-883b-b0d701710847[panopto,width=360]


====


=== 自動化參數文件

[%collapsible%open]
====
Ansible playbook 使用預先定義參數執行資料庫安裝和設定任務。對於此 Oracle 自動化解決方案，有三個使用者定義的參數檔案需要在劇本執行之前使用者輸入。

* 主機 - 定義自動化劇本運作的目標。
* vars/vars.yml - 定義適用於所有目標的變數的全域變數檔案。
* host_vars/host_name.yml - 定義僅適用於命名目標的變數的本機變數檔案。在我們的用例中，這些是 Oracle DB 伺服器。


除了這些使用者定義的變數文件之外，還有幾個預設變數文件，其中包含預設參數，除非必要，否則不需要更改。以下部分介紹如何設定使用者定義的變數檔。

====


=== 參數檔案配置

[%collapsible%open]
====
. Ansible 目標 `hosts`文件配置：
+
[source, shell]
----
# Enter Amazon FSx ONTAP management IP address
[ontap]
172.16.9.32

# Enter name for ec2 instance (not default IP address naming) to be deployed one by one, follow by ec2 instance IP address, and ssh private key of ec2-user for the instance.
[oracle]
ora_01 ansible_host=10.61.180.21 ansible_ssh_private_key_file=ora_01.pem
ora_02 ansible_host=10.61.180.23 ansible_ssh_private_key_file=ora_02.pem

----


. 全球的 `vars/vars.yml`文件配置
+
[source, shell]
----
#############################################################################################################
######                 Oracle 19c deployment global user configurable variables                        ######
######                 Consolidate all variables from ONTAP, linux and oracle                          ######
#############################################################################################################

#############################################################################################################
######                 ONTAP env specific config variables                                             ######
#############################################################################################################

# Enter the supported ONTAP platform: on-prem, aws-fsx.
ontap_platform: aws-fsx

# Enter ONTAP cluster management user credentials
username: "fsxadmin"
password: "xxxxxxxx"

#############################################################################################################
###                   Linux env specific config variables                                                 ###
#############################################################################################################

# Enter RHEL subscription to enable repo
redhat_sub_username: xxxxxxxx
redhat_sub_password: "xxxxxxxx"


#############################################################################################################
###                   Oracle DB env specific config variables                                             ###
#############################################################################################################

# Enter Database domain name
db_domain: solutions.netapp.com

# Enter initial password for all required Oracle passwords. Change them after installation.
initial_pwd_all: xxxxxxxx

----


. 本地資料庫伺服器 `host_vars/host_name.yml`配置如ora_01.yml，ora_02.yml...
+
[source, shell]
----
# User configurable Oracle host specific parameters

# Enter container database SID. By default, a container DB is created with 3 PDBs within the CDB
oracle_sid: NTAP1

# Enter database shared memory size or SGA. CDB is created with SGA at 75% of memory_limit, MB. The grand total of SGA should not exceed 75% available RAM on node.
memory_limit: 8192

----


====


=== 劇本執行

[%collapsible%open]
====
自動化工具包中共有六個劇本。每個執行不同的任務區塊並服務於不同的目的。

....
0-all_playbook.yml - execute playbooks from 1-4 in one playbook run.
1-ansible_requirements.yml - set up Ansible controller with required libs and collections.
2-linux_config.yml - execute Linux kernel configuration on Oracle DB servers.
3-ontap_config.yml - configure ONTAP svm/volumes/luns for Oracle database and grant DB server access to luns.
4-oracle_config.yml - install and configure Oracle on DB servers for grid infrastructure and create a container database.
5-destroy.yml - optional to undo the environment to dismantle all.
....
有三個選項可以使用以下命令運行劇本。

. 在一次組合運行中執行所有部署劇本。
+
[source, cli]
----
ansible-playbook -i hosts 0-all_playbook.yml -u ec2-user -e @vars/vars.yml
----
. 依照 1-4 的數字序列逐一執行劇本。
+
[source, cli]]
----
ansible-playbook -i hosts 1-ansible_requirements.yml -u ec2-user -e @vars/vars.yml
----
+
[source, cli]
----
ansible-playbook -i hosts 2-linux_config.yml -u ec2-user -e @vars/vars.yml
----
+
[source, cli]
----
ansible-playbook -i hosts 3-ontap_config.yml -u ec2-user -e @vars/vars.yml
----
+
[source, cli]
----
ansible-playbook -i hosts 4-oracle_config.yml -u ec2-user -e @vars/vars.yml
----
. 使用標籤執行 0-all_playbook.yml。
+
[source, cli]
----
ansible-playbook -i hosts 0-all_playbook.yml -u ec2-user -e @vars/vars.yml -t ansible_requirements
----
+
[source, cli]
----
ansible-playbook -i hosts 0-all_playbook.yml -u ec2-user -e @vars/vars.yml -t linux_config
----
+
[source, cli]
----
ansible-playbook -i hosts 0-all_playbook.yml -u ec2-user -e @vars/vars.yml -t ontap_config
----
+
[source, cli]
----
ansible-playbook -i hosts 0-all_playbook.yml -u ec2-user -e @vars/vars.yml -t oracle_config
----
. 撤銷環境
+
[source, cli]
----
ansible-playbook -i hosts 5-destroy.yml -u ec2-user -e @vars/vars.yml
----


====


=== 執行後驗證

[%collapsible%open]
====
劇本運行後，以 oracle 使用者登入 Oracle DB 伺服器，驗證 Oracle 網格基礎架構和資料庫是否成功建立。以下是主機 ora_01 上的 Oracle 資料庫驗證的範例。

. 驗證 EC2 執行個體上的 Oracle 容器資料庫
+
....

[admin@ansiblectl na_oracle_deploy_iscsi]$ ssh -i ora_01.pem ec2-user@172.30.15.40
Last login: Fri Dec  8 17:14:21 2023 from 10.61.180.18
[ec2-user@ip-172-30-15-40 ~]$ uname -a
Linux ip-172-30-15-40.ec2.internal 4.18.0-372.9.1.el8.x86_64 #1 SMP Fri Apr 15 22:12:19 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux

[ec2-user@ip-172-30-15-40 ~]$ sudo su
[root@ip-172-30-15-40 ec2-user]# su - oracle
Last login: Fri Dec  8 16:25:52 UTC 2023 on pts/0
[oracle@ip-172-30-15-40 ~]$ sqlplus / as sysdba

SQL*Plus: Release 19.0.0.0.0 - Production on Fri Dec 8 18:18:20 2023
Version 19.18.0.0.0

Copyright (c) 1982, 2022, Oracle.  All rights reserved.


Connected to:
Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.18.0.0.0

SQL> select name, open_mode, log_mode from v$database;

NAME      OPEN_MODE            LOG_MODE
--------- -------------------- ------------
NTAP1     READ WRITE           ARCHIVELOG

SQL> show pdbs

    CON_ID CON_NAME                       OPEN MODE  RESTRICTED
---------- ------------------------------ ---------- ----------
         2 PDB$SEED                       READ ONLY  NO
         3 NTAP1_PDB1                     READ WRITE NO
         4 NTAP1_PDB2                     READ WRITE NO
         5 NTAP1_PDB3                     READ WRITE NO
SQL> select name from v$datafile;

NAME
--------------------------------------------------------------------------------
+DATA/NTAP1/DATAFILE/system.257.1155055419
+DATA/NTAP1/DATAFILE/sysaux.258.1155055463
+DATA/NTAP1/DATAFILE/undotbs1.259.1155055489
+DATA/NTAP1/86B637B62FE07A65E053F706E80A27CA/DATAFILE/system.266.1155056241
+DATA/NTAP1/86B637B62FE07A65E053F706E80A27CA/DATAFILE/sysaux.267.1155056241
+DATA/NTAP1/DATAFILE/users.260.1155055489
+DATA/NTAP1/86B637B62FE07A65E053F706E80A27CA/DATAFILE/undotbs1.268.1155056241
+DATA/NTAP1/0C03AAFA7C6FD2E5E063280F1EACFBE0/DATAFILE/system.272.1155057059
+DATA/NTAP1/0C03AAFA7C6FD2E5E063280F1EACFBE0/DATAFILE/sysaux.273.1155057059
+DATA/NTAP1/0C03AAFA7C6FD2E5E063280F1EACFBE0/DATAFILE/undotbs1.271.1155057059
+DATA/NTAP1/0C03AAFA7C6FD2E5E063280F1EACFBE0/DATAFILE/users.275.1155057075

NAME
--------------------------------------------------------------------------------
+DATA/NTAP1/0C03AC0089ACD352E063280F1EAC12BD/DATAFILE/system.277.1155057075
+DATA/NTAP1/0C03AC0089ACD352E063280F1EAC12BD/DATAFILE/sysaux.278.1155057075
+DATA/NTAP1/0C03AC0089ACD352E063280F1EAC12BD/DATAFILE/undotbs1.276.1155057075
+DATA/NTAP1/0C03AC0089ACD352E063280F1EAC12BD/DATAFILE/users.280.1155057091
+DATA/NTAP1/0C03ACEABA54D386E063280F1EACE573/DATAFILE/system.282.1155057091
+DATA/NTAP1/0C03ACEABA54D386E063280F1EACE573/DATAFILE/sysaux.283.1155057091
+DATA/NTAP1/0C03ACEABA54D386E063280F1EACE573/DATAFILE/undotbs1.281.1155057091
+DATA/NTAP1/0C03ACEABA54D386E063280F1EACE573/DATAFILE/users.285.1155057105

19 rows selected.

SQL> select name from v$controlfile;

NAME
--------------------------------------------------------------------------------
+DATA/NTAP1/CONTROLFILE/current.261.1155055529
+LOGS/NTAP1/CONTROLFILE/current.256.1155055529

SQL> select member from v$logfile;

MEMBER
--------------------------------------------------------------------------------
+DATA/NTAP1/ONLINELOG/group_3.264.1155055531
+LOGS/NTAP1/ONLINELOG/group_3.259.1155055539
+DATA/NTAP1/ONLINELOG/group_2.263.1155055531
+LOGS/NTAP1/ONLINELOG/group_2.257.1155055539
+DATA/NTAP1/ONLINELOG/group_1.262.1155055531
+LOGS/NTAP1/ONLINELOG/group_1.258.1155055539

6 rows selected.

SQL> exit
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.18.0.0.0

....
. 驗證 Oracle 監聽器。
+
....

[oracle@ip-172-30-15-40 ~]$ lsnrctl status listener

LSNRCTL for Linux: Version 19.0.0.0.0 - Production on 08-DEC-2023 18:20:24

Copyright (c) 1991, 2022, Oracle.  All rights reserved.

Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=ip-172-30-15-40.ec2.internal)(PORT=1521)))
STATUS of the LISTENER
------------------------
Alias                     LISTENER
Version                   TNSLSNR for Linux: Version 19.0.0.0.0 - Production
Start Date                08-DEC-2023 16:26:09
Uptime                    0 days 1 hr. 54 min. 14 sec
Trace Level               off
Security                  ON: Local OS Authentication
SNMP                      OFF
Listener Parameter File   /u01/app/oracle/product/19.0.0/grid/network/admin/listener.ora
Listener Log File         /u01/app/oracle/diag/tnslsnr/ip-172-30-15-40/listener/alert/log.xml
Listening Endpoints Summary...
  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=ip-172-30-15-40.ec2.internal)(PORT=1521)))
  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1521)))
  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcps)(HOST=ip-172-30-15-40.ec2.internal)(PORT=5500))(Security=(my_wallet_directory=/u01/app/oracle/product/19.0.0/NTAP1/admin/NTAP1/xdb_wallet))(Presentation=HTTP)(Session=RAW))
Services Summary...
Service "+ASM" has 1 instance(s).
  Instance "+ASM", status READY, has 1 handler(s) for this service...
Service "+ASM_DATA" has 1 instance(s).
  Instance "+ASM", status READY, has 1 handler(s) for this service...
Service "+ASM_LOGS" has 1 instance(s).
  Instance "+ASM", status READY, has 1 handler(s) for this service...
Service "0c03aafa7c6fd2e5e063280f1eacfbe0.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "0c03ac0089acd352e063280f1eac12bd.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "0c03aceaba54d386e063280f1eace573.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "NTAP1.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "NTAP1XDB.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "ntap1_pdb1.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "ntap1_pdb2.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
Service "ntap1_pdb3.solutions.netapp.com" has 1 instance(s).
  Instance "NTAP1", status READY, has 1 handler(s) for this service...
The command completed successfully

....
. 驗證創建的電網基礎設施和資源。
+
....

[oracle@ip-172-30-15-40 ~]$ asm
[oracle@ip-172-30-15-40 ~]$ crsctl check has
CRS-4638: Oracle High Availability Services is online
[oracle@ip-172-30-15-40 ~]$ crsctl stat res -t
--------------------------------------------------------------------------------
Name           Target  State        Server                   State details
--------------------------------------------------------------------------------
Local Resources
--------------------------------------------------------------------------------
ora.DATA.dg
               ONLINE  ONLINE       ip-172-30-15-40          STABLE
ora.LISTENER.lsnr
               ONLINE  ONLINE       ip-172-30-15-40          STABLE
ora.LOGS.dg
               ONLINE  ONLINE       ip-172-30-15-40          STABLE
ora.asm
               ONLINE  ONLINE       ip-172-30-15-40          Started,STABLE
ora.ons
               OFFLINE OFFLINE      ip-172-30-15-40          STABLE
--------------------------------------------------------------------------------
Cluster Resources
--------------------------------------------------------------------------------
ora.cssd
      1        ONLINE  ONLINE       ip-172-30-15-40          STABLE
ora.diskmon
      1        OFFLINE OFFLINE                               STABLE
ora.driver.afd
      1        ONLINE  ONLINE       ip-172-30-15-40          STABLE
ora.evmd
      1        ONLINE  ONLINE       ip-172-30-15-40          STABLE
ora.ntap1.db
      1        ONLINE  ONLINE       ip-172-30-15-40          Open,HOME=/u01/app/o
                                                             racle/product/19.0.0
                                                             /NTAP1,STABLE
--------------------------------------------------------------------------------

....
. 驗證 Oracle ASM。
+
....

[oracle@ip-172-30-15-40 ~]$ asmcmd
ASMCMD> lsdg
State    Type    Rebal  Sector  Logical_Sector  Block       AU  Total_MB  Free_MB  Req_mir_free_MB  Usable_file_MB  Offline_disks  Voting_files  Name
MOUNTED  EXTERN  N         512             512   4096  4194304    163840   155376                0          155376              0             N  DATA/
MOUNTED  EXTERN  N         512             512   4096  4194304     81920    80972                0           80972              0             N  LOGS/
ASMCMD> lsdsk
Path
AFD:ORA_01_DAT1_01
AFD:ORA_01_DAT1_03
AFD:ORA_01_DAT2_02
AFD:ORA_01_DAT2_04
AFD:ORA_01_LOGS_01
AFD:ORA_01_LOGS_02
ASMCMD> afd_state
ASMCMD-9526: The AFD state is 'LOADED' and filtering is 'ENABLED' on host 'ip-172-30-15-40.ec2.internal'
ASMCMD> exit

....
. 登入 Oracle Enterprise Manager Express 來驗證資料庫。
+
image:automation-ora-aws-fsx-iscsi-em-001.png["此映像提供 Oracle Enterprise Manager Express 的登入畫面"] image:automation-ora-aws-fsx-iscsi-em-002.png["此映像提供了 Oracle Enterprise Manager Express 的容器資料庫視圖"] image:automation-ora-aws-fsx-iscsi-em-003.png["此映像提供了 Oracle Enterprise Manager Express 的容器資料庫視圖"]



====


=== 使用SnapCenter進行 Oracle 備份、復原和克隆

[%collapsible%open]
====
參考 TR-4979link:../oracle/aws-ora-fsx-vmc-guestmount.html#oracle-backup-restore-and-clone-with-snapcenter["VMware Cloud on AWS 中簡化的自主管理 Oracle，附有用戶端安裝的 FSx ONTAP"^]部分 `Oracle backup, restore, and clone with SnapCenter`有關設定SnapCenter和執行資料庫備份、復原和複製工作流程的詳細資訊。

====


== 在哪裡可以找到更多信息

要了解有關本文檔中描述的信息的更多信息，請查看以下文檔和/或網站：

* Amazon FSx ONTAP
+
link:https://aws.amazon.com/fsx/netapp-ontap/["https://aws.amazon.com/fsx/netapp-ontap/"^]

* 亞馬遜 EC2
+
link:https://aws.amazon.com/pm/ec2/?trk=36c6da98-7b20-48fa-8225-4784bced9843&sc_channel=ps&s_kwcid=AL!4422!3!467723097970!e!!g!!aws%20ec2&ef_id=Cj0KCQiA54KfBhCKARIsAJzSrdqwQrghn6I71jiWzSeaT9Uh1-vY-VfhJixF-xnv5rWwn2S7RqZOTQ0aAh7eEALw_wcB:G:s&s_kwcid=AL!4422!3!467723097970!e!!g!!aws%20ec2["https://aws.amazon.com/pm/ec2/?trk=36c6da98-7b20-48fa-8225-4784bced9843&sc_channel=ps&s_kwcid=AL!4422!3!467723097970!e!!g!!aws%20ec2&ef_id=Cj0KCQiA54KfBhCKARIsAJzSrdqwQrghn6I71jiWzSeaT9Uh1-vY-VfhJixF-xnv5rWwn2S7RqZOTQ0aAh7eEALw_wcB:G:s&s_kwcid=AL!4422!3!467723097970!e!!g!!aws%20ec2"^]

* 使用新資料庫安裝為獨立伺服器安裝 Oracle Grid Infrastructure
+
link:https://docs.oracle.com/en/database/oracle/oracle-database/19/ladbi/installing-oracle-grid-infrastructure-for-a-standalone-server-with-a-new-database-installation.html#GUID-0B1CEE8C-C893-46AA-8A6A-7B5FAAEC72B3["https://docs.oracle.com/en/database/oracle/oracle-database/19/ladbi/installing-oracle-grid-infrastructure-for-a-standalone-server-with-a-new-database-installation.html#GUID-0B1CEE8C-C893-46AA-8A6A-7B5FAAEC72B3"^]

* 使用回應檔案安裝和配置 Oracle 資料庫
+
link:https://docs.oracle.com/en/database/oracle/oracle-database/19/ladbi/installing-and-configuring-oracle-database-using-response-files.html#GUID-D53355E9-E901-4224-9A2A-B882070EDDF7["https://docs.oracle.com/en/database/oracle/oracle-database/19/ladbi/installing-and-configuring-oracle-database-using-response-files.html#GUID-D53355E9-E901-4224-9A2A-B882070EDDF7"^]

* 將 Red Hat Enterprise Linux 8.2 與ONTAP結合使用
+
link:https://docs.netapp.com/us-en/ontap-sanhost/hu_rhel_82.html#all-san-array-configurations["https://docs.netapp.com/us-en/ontap-sanhost/hu_rhel_82.html#all-san-array-configurations"^]


